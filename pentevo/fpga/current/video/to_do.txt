
DMA:
 - code access to ports with blocking strobes
 - code z80 wait
 - separate INT for DMA with vector
 - option to receive INT before burst end (?)
 - multilevel INT (delayed for non-VINT)

Fixes:
 - fix PWM for TV (make smoother)
 - fix vertical blank for border 1 pixel at the upper-right corner
 - learn what is read to rddata by c4
 - SYSConfig and CPU clock select
 - fix Xscroll for text mode
 - make proper clocked altdprams
 - make CRAM clocked: zclk for WE and fclk for RE
 - search ways to optimize huge LC usage - one-hot style selectors

Features:
 - DOS switch to RAM #FF when in/out to VG93 and FDDVirt[(#FF)]
 - back to DOS by ld b,b (opcode #40) + jmp nnnn (next but one M1)

 - horizontal scrollers (array)
 - vertical scrollers (unified with Tile mode)
 - RAM / ROM paging
 - 512 bytes no-wait buffer
 - IM2 vector to Z80 bus (RTFM z80 UG)
 - LOAD "" for COM-port using X-modem
 - make less power-off delay (apx. 2 sec) on AVR
 
 

NOTES:

When add addr mux for TS address - clk slack is getting "-".
Fix it by optimizing timings.

 
 
 
 Sprites 'n' Tiles
 -----------------
 
Sprites:

 Nr of sprites: 42 (252 bytes)
 Sized: 16/32/48/64 pix individually for X and Y
 Min sprite (16x16) = 128 bytes = 64 words (6 bits)
 Max sprite (64x64) = 2048 bytes = 1024 words
 Total addressable space 21 - 6 = 15 bits
 
 bits	desc
 9		X coord
 9		Y coord
 2		X size
 2		Y size
 1		X flip
 1		Y flip
 15		addr
 4		palette
 1		active
 1		leap
 ---------------------
 45		totally of 48


 0 - XXXX XXXX
 1 - PPPP FSSX
 2 - YYYY YYYY
 3 - LCxx FSSY
 4 - AAAA AAAx
 5 - AAAA AAAA
 

Tiles:

 Sized: 8x8
 Tile: 32 bytes = 16 words = 4 bits
 Screen 360x288 = 45x36 = 1620 tiles = 51840 bytes
 Plane 512x512 = 64x64 = 4096 tiles = 128kB = 64kW = 16 bits (8 pages)

 bits	desc
 12		tile
 1		X flip
 1		Y flip
 2		palette
 ---------------------
 16		totally of 16
 
 
 
 
 Layers (from bottom):

 for tile mode 0
1 - border
2 - sprites (until 1st leap)	
3 - tiles0
4 - sprites (until 2nd leap)
5 - sprites (until 3rd leap)


 for tile mode 1
1 - border
2 - sprites (until 1st leap)	
3 - tiles0
4 - sprites (until 2nd leap)
5 - tiles1
6 - sprites (until 3rd leap)


 for pixel modes
 
1 - pixel graphics
2 - sprites (until 1st leap)	
3 - sprites (until 2nd leap)
4 - sprites (until 3rd leap)
 

 